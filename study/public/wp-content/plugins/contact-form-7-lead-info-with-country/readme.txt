=== Contact Form 7 Lead info with country ===
Contributors: apasionados, netconsulting
Donate link: http://apasionados.es/
Tags: contact form 7, contact form, contact, lead tracking, user info, user visit, country, ip, email, form
Requires at least: 3.5
Tested up to: 4.9
Requires PHP: 5.3
Stable tag: 1.4.3
License: GPLv2 or later
License URI: http://www.gnu.org/licenses/gpl-2.0.html

Contact Form 7 Lead Info with country helps to track users that fill in forms. 

== Description ==

Contact Form 7 Lead info with country is an **addon module for the [Contact Form 7](https://wordpress.org/plugins/contact-form-7/) plugin**. It helps you track the user who fills out a form.
All you need to do is add the [tracking-info] shortcode in the Message body of the contact form 7.

This plugin is an enhanced version of the plugin [Contact Form 7 Leads Tracking](https://wordpress.org/plugins/contact-form-7-leads-tracking/), that includes translations and the lookup of the country of the IP from which the form is sent.

We decided to create this enhanced version of the plugin, because we needed a translation to Spanish and wanted to know the country from which the uses send the contact form, whithout having to lookup the IP adress.

The lead tracking info includes: Form Page URL, Original Referrer, Landing Page, User IP, Country of the User IP and Browser.

In order to display the Country it needs the [GeoIP Detection plugin](https://wordpress.org/plugins/geoip-detect/) that can be found in the WordPress plugin repository. This plugin "provides geographic information detected by an IP adress". *This plugin auto-updates the GeoIP database once a week. This product includes GeoLite data created by MaxMind, available from [www.maxmind.com](http://www.maxmind.com).*

If the [GeoIP Detection plugin](https://wordpress.org/plugins/geoip-detect/) is not installed and enabled, you will only see the IP address, without the country of the IP adress.

We decided to use the GEOIP DETECTION plugin to handle the lookup of the country, because it's a plugin that is actively developed and we saw no advantage in implementing all this functionality, when we could use an existing one.

The lead tracking info in this plugin includes:

1. **Form Page URL**
    The URL on which the user filled out the form.

1. **Original Referrer**
    The URL from which the user came to your site.

1. **Landing Page**
    The first page the user visited on your site.

1. **User IP**
    The IP address of the user who filled out the form.

1. **Country of the IP**
    The country of the IP address of the user who filled out the form. If the country is 0, please check the FAQ information.
	
1. **User Agent / Browser**
    The browser information of the user who filled the form.
 
> **Please make sure that WP_DEBUG in wp-config.php is set to FALSE when using this plugin in production.** If it's true the message is sent but the AJAX code to show the OK message and clear the form is not executed. This has to do with the Contact Form 7 filter: *wpcf7_mail_components* we use for adding the tracking information and we can't change this behaviour. Please be aware of this.
 
= CONTACT FORM 7 LEAD INFO WITH COUNTRY in your Language! =
This first release is avaliable in English and Spanish. In the languages folder we have included the necessary files to translate this plugin.

If you would like the plugin in your language and you're good at translating, please drop us a line at [Contact us](http://apasionados.es/contacto/index.php?desde=wordpress-org-contactform7leadinfowithcountry-home).

= Further Reading =
You can access the description of the plugin in Spanish at: [Contact Form 7 Lead info with country en castellano](http://apasionados.es/blog/informacion-pais-contact-form-7-plugin-wordpress-6061/).


== Installation ==

1. Upload the `contact-form-7-lead-info-with-country` folder to the `/wp-content/plugins/` directory (or to the directory where your WordPress plugins are located)
1. Activate the "Contact Form 7 Lead info with country" plugin through the 'Plugins' menu in WordPress.
1. Plugin doesn't need any configuration.

== Screenshots ==

1. A sample email with the tracking information generated by the plugin.

== Frequently Asked Questions ==

= What is CONTACT FORM 7 LEAD INFO WITH COUNTRY good for? =
This plugin adds the Form Page URL, Original Referrer, Landing Page, User IP, Country of the User IP and Browser to Contact Form 7 when inserting the [tracking-info] shortcode in the Message body.

= Do I need to install another plugin to make this one work?  =
Contact Form 7 Lead info with country is an **addon module for the Contact Form 7 plugin**. You need to have [Contact Form 7](https://wordpress.org/plugins/contact-form-7/) installed and active.
In order to display the Country it needs the [GeoIP Detection plugin](https://wordpress.org/plugins/geoip-detect/) that can be found in the WordPress plugin repository. This plugin "provides geographic information detected by an IP adress". *This plugin auto-updates the GeoIP database once a week. This product includes GeoLite data created by MaxMind, available from [www.maxmind.com](http://www.maxmind.com).*

If the [GeoIP Detection plugin](https://wordpress.org/plugins/geoip-detect/) is not installed and enabled, you will only see the IP address, without the country of the IP adress.

IMPORTANT: When you install the GeoIP Detection plugin for the first time, it's important that you go to Tools > GeoIP Detection and click on "Upgrade now". When activated the plugin does not download the GeoIP database automatically. You have to download it the first time by clicking on "Upgrade now". If you don't install the database, the Country code is 0.

= The result for the Country is 0. What can I do? =
When you install the GeoIP Detection plugin for the first time, it's important that you go to Tools > GeoIP Detection and click on "Upgrade now". When activated the plugin does not download the GeoIP database automatically. You have to download it the first time by clicking on "Upgrade now". If you don't install the database, the Country code is 0.

= How exact is the Country data? =
Think of it as an "educated guess": IP adresses and their allocation change on a frequent basis. If you need [more exact data](http://www.maxmind.com/en/geolite_city_accuracy), consider purchasing the commercial version of the data.

= Does CONTACT FORM 7 LEAD INFO WITH COUNTRY make changes to the database? =
The plugin doesn't make any changes to the database. It only adds the tracking info to the email sent by contact form 7.

= How can I check out if the plugin works for me? =
Install and activate. Paste shortcode in Contact Form 7 Message body. Test contact form. In the email you receive you should see the tracking info added where you placed the shortocde.

= How can I remove CONTACT FORM 7 LEAD INFO WITH COUNTRY? =
You can simply activate, deactivate or delete it in your plugin management section.

= Are there any known incompatibilities? =
If you are using [Contact Form 7 Leads Tracking](https://wordpress.org/plugins/contact-form-7-leads-tracking/) and this plugin is active, the CONTACT FORM 7 LEAD INFO WITH COUNTRY will not work.

= Why does this plugin offer no support for Wordpress versions before 3.5? =
Because the [GeoIP Detection plugin](https://wordpress.org/plugins/geoip-detect/) needs at least WordPress 3.5, we decided to also ask for a version equal or higher than WordPress 3.5. 

= When using this plugin and send a message in a contact form apparently nothing happens =
Please make sure that WP_DEBUG in wp-config.php is set to FALSE when using this plugin in production. If it's true the message is sent but the AJAX code to show the OK message and clear the form is not executed.

= Do you make use of CONTACT FORM 7 LEAD INFO WITH COUNTRY yourself? = 
Of course we do. ;-)

== Changelog ==

= 1.4.3 (12/JUL/2018) =
* Removed line break when PROXY is detected.

= 1.4.2 (03/JAN/2018) =
* Added declaration of variable $trackingInfo to avoid "Notice: Undefined variable: cf7isSecure" with PHP 7.

= 1.4.1 (10/SEP/2017) =
* Added declaration of variable $cf7ltisSecure to avoid "Notice: Undefined variable: cf7isSecure" with PHP 7.

= 1.4.0 =
* Added check for landing page protocol. Now it will show https or http depending if there is a SSL certificate in use on the landing page.

= 1.3.2 =
* Added GEO info for Proxy Server IP when set.

= 1.3.1 =
* Some code improvements.

= 1.3 =
* Changed function used to retrieve the IP data from "GeoIP Detection" to support reverse proxies.

= 1.2 =
* Solved error when WordPress DEBUG was true: "Notice: Undefined index: HTTP_REFERER" when HTTP_REFERER was not set by browser

= 1.1.1 =
* Change to solve error in line 101 of the plugin when WordPress DEBUG is TRUE: Notice: "Undefined index: HTTP_REFERER in contact-form-7-lead-info-with-country/wpshore_cf7_lead_tracking.php on line 101"

= 1.1 =
* First stable release.

= 1.0 =
* Second beta release.

= 0.5 =
* Beta release.

== Upgrade Notice ==

= 1.4.3 =
Removed line break when PROXY is detected.

== Contact ==

For further information please send us an [email](http://apasionados.es/contacto/index.php?desde=wordpress-org-contactform7leadinfowithcountry-contact).
